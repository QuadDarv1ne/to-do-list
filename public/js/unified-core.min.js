!function(){"use strict";if(window.__unifiedCoreLoaded)return void console.warn("Unified Core already loaded");window.__unifiedCoreLoaded=!0,window.showToast=function(e,t="info"){let o=document.getElementById("toast-container");o||(o=document.createElement("div"),o.id="toast-container",o.style.cssText="position:fixed;top:20px;right:20px;z-index:9999;max-width:400px;",document.body.appendChild(o));const n={success:"fa-check-circle",error:"fa-exclamation-circle",warning:"fa-exclamation-triangle",info:"fa-info-circle",danger:"fa-times-circle"},r={success:"linear-gradient(135deg, #10b981 0%, #059669 100%)",error:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",warning:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",info:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",danger:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)"},i=document.createElement("div");i.className="toast-notification",i.style.cssText=`\n            display:flex;align-items:center;gap:12px;padding:14px 18px;\n            margin-bottom:10px;border-radius:12px;color:#fff;\n            background:${r[t]||r.info};\n            box-shadow:0 8px 24px rgba(0,0,0,0.2);\n            transform:translateX(400px);opacity:0;\n            transition:all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n        `,i.setAttribute("role","alert"),i.innerHTML=`\n            <i class="fas ${n[t]||n.info}" style="font-size:20px;"></i>\n            <span style="flex:1;font-size:14px;font-weight:500;">${e}</span>\n            <button onclick="this.parentElement.remove()" style="background:none;border:none;color:#fff;cursor:pointer;font-size:20px;padding:0;opacity:0.7;transition:opacity 0.2s;" aria-label="Закрыть">\n                <i class="fas fa-times"></i>\n            </button>\n        `,o.appendChild(i),requestAnimationFrame(()=>{i.style.transform="translateX(0)",i.style.opacity="1"}),setTimeout(()=>{i.style.transform="translateX(400px)",i.style.opacity="0",setTimeout(()=>i.remove(),400)},5e3)},window.debounce=function(e,t=300){let o;return function(...n){clearTimeout(o),o=setTimeout(()=>{clearTimeout(o),e(...n)},t)}},window.throttle=function(e,t=300){let o;return function(...n){o||(e.apply(this,n),o=!0,setTimeout(()=>o=!1,t))}},window.storage={set:(e,t)=>{try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(e){return console.error("Storage error:",e),!1}},get:(e,t=null)=>{try{const o=localStorage.getItem(e);return o?JSON.parse(o):t}catch(e){return console.error("Storage error:",e),t}},remove:e=>{try{return localStorage.removeItem(e),!0}catch(e){return console.error("Storage error:",e),!1}},clear:()=>{try{return localStorage.clear(),!0}catch(e){return console.error("Storage error:",e),!1}}},window.fetchJSON=async function(e,t={}){try{const o=await fetch(e,{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...t.headers},...t});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(e){throw console.error("Fetch error:",e),e}},window.validateForm=function(e){const t=e.querySelectorAll("input[required], textarea[required], select[required]");let o=!0;return t.forEach(e=>{e.value.trim()?e.classList.remove("is-invalid"):(e.classList.add("is-invalid"),o=!1)}),o},window.formatDate=function(e,t="short"){const o=new Date(e);return"short"===t?o.toLocaleDateString("ru-RU"):"long"===t?o.toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}):"time"===t?o.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}):"datetime"===t?o.toLocaleString("ru-RU"):o.toLocaleDateString("ru-RU")},window.copyToClipboard=function(e){function t(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();try{document.execCommand("copy"),window.showToast("Скопировано в буфер обмена","success")}catch(e){console.error("Fallback copy failed:",e),window.showToast("Ошибка копирования","error")}document.body.removeChild(t)}navigator.clipboard?navigator.clipboard.writeText(e).then(()=>{window.showToast("Скопировано в буфер обмена","success")}).catch(o=>{console.error("Copy failed:",o),t(e)}):t(e)},window.escapeHtml=function(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML},window.getQueryParam=function(e){return new URLSearchParams(window.location.search).get(e)},window.scrollToElement=function(e,t=0){if(!e)return;const o=e.getBoundingClientRect().top+window.pageYOffset-t;window.scrollTo({top:o,behavior:"smooth"})},window.isInViewport=function(e){if(!e)return!1;const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},window.showLoading=function(e){e&&(e.classList.add("loading"),e.setAttribute("disabled","disabled"))},window.hideLoading=function(e){e&&(e.classList.remove("loading"),e.removeAttribute("disabled"))},window.confirmAction=function(e,t){confirm(e)&&t()};const e=document.getElementById("pageLoader");e&&window.addEventListener("load",()=>{setTimeout(()=>{e.classList.add("hidden"),document.body.classList.add("loaded")},300)}),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll('[data-bs-toggle="tooltip"]');"undefined"!=typeof bootstrap&&bootstrap.Tooltip&&[...e].map(e=>new bootstrap.Tooltip(e));const t=document.querySelectorAll('[data-bs-toggle="popover"]');"undefined"!=typeof bootstrap&&bootstrap.Popover&&[...t].map(e=>new bootstrap.Popover(e))}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("logoutModal");if(e){const t=e.querySelector("#confirmLogout");t&&t.addEventListener("click",()=>{window.location.href="/logout"})}}),console.log("✨ Unified Core v3.0 initialized")}();