!function(){"use strict";window.scriptLoader=new class{constructor(){this.loadedScripts=new Set,this.loadingScripts=new Map,this.scriptQueue=[],this.isProcessing=!1}load(e,t="normal",o=!1){if(this.loadedScripts.has(e))return Promise.resolve();if(this.loadingScripts.has(e))return this.loadingScripts.get(e);const n=new Promise((t,n)=>{const a=document.createElement("script");a.src=e,a.async=!o,a.defer=o,a.onload=()=>{this.loadedScripts.add(e),this.loadingScripts.delete(e),t()},a.onerror=()=>{console.warn(`Failed to load script: ${e}`),this.loadingScripts.delete(e),n(new Error(`Failed to load ${e}`))},document.head.appendChild(a)});return this.loadingScripts.set(e,n),n}preload(e){const t=document.createElement("link");t.rel="preload",t.as="script",t.href=e,document.head.appendChild(t)}async loadBatch(e,t="normal"){const o=e.map(e=>this.load(e,t));return Promise.all(o)}scheduleLoad(e,t=1e3){setTimeout(()=>this.load(e),t)}scheduleBatch(e,t=1e3){setTimeout(()=>this.loadBatch(e),t)}getStats(){return{loaded:this.loadedScripts.size,loading:this.loadingScripts.size,scripts:Array.from(this.loadedScripts)}}};class e{constructor(){this.observers=new Map,this.init()}init(){"IntersectionObserver"in window?this.observeLazyComponents():this.loadAll()}observeLazyComponents(){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(this.loadComponent(t.target),e.unobserve(t.target))})},{rootMargin:"100px",threshold:.01});document.querySelectorAll("[data-lazy-component]").forEach(t=>{e.observe(t)})}loadComponent(e){const t={chart:"/js/charts.js",calendar:"/js/calendar-enhanced.js",kanban:"/js/kanban-enhanced.js",dashboard:"/js/dashboard-enhanced.js",notifications:"/js/realtime-notifications.js",search:"/js/quick-search.js",table:"/js/table-enhancements.js"}[e.dataset.lazyComponent];t&&window.scriptLoader.load(t,"high")}loadAll(){document.querySelectorAll("[data-lazy-component]").forEach(e=>{this.loadComponent(e)})}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{window.componentLoader=new e}):window.componentLoader=new e;function t(){(window.location.pathname.includes("/analytics")||window.location.pathname.includes("/dashboard"))&&window.scriptLoader.load("/js/dashboard-widgets.js","high"),window.location.pathname.includes("/calendar")&&window.scriptLoader.load("/js/calendar-enhanced.js","high"),window.location.pathname.includes("/kanban")&&window.scriptLoader.load("/js/kanban-enhanced.js","high"),window.location.pathname.includes("/task")&&(window.scriptLoader.load("/js/table-enhancements.js","high"),window.scriptLoader.load("/js/task-inline-edit.js","high")),window.scriptLoader.load("/js/quick-search.js","normal");document.querySelector('meta[name="csrf-token"]')&&window.scriptLoader.load("/js/realtime-notifications.js","normal"),window.scriptLoader.scheduleLoad("/js/global-interactions.js",500),window.scriptLoader.scheduleLoad("/js/ui-enhancements.js",1e3),window.scriptLoader.scheduleLoad("/js/offline-support.js",2e3);"dev"===document.body.dataset.environment&&window.scriptLoader.scheduleLoad("/js/performance-monitor.js",3e3)}window.eventOptimizer=new class{constructor(){this.debounceTimers=new Map,this.throttleTimers=new Map}debounce(e,t,o="default"){return(...n)=>{clearTimeout(this.debounceTimers.get(o)),this.debounceTimers.set(o,setTimeout(()=>e.apply(this,n),t))}}throttle(e,t,o="default"){return(...n)=>{this.throttleTimers.has(o)||(e.apply(this,n),this.throttleTimers.set(o,setTimeout(()=>{this.throttleTimers.delete(o)},t)))}}addPassiveListener(e,t,o,n={}){e.addEventListener(t,o,{passive:!0,capture:!1,...n})}},window.requestIdleCallback=window.requestIdleCallback||function(e){const t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)};const o=window.eventOptimizer.debounce(function(){document.documentElement.style.setProperty("--vh",window.innerHeight+"px")},250,"resize");function n(){"requestIdleCallback"in window?requestIdleCallback(t,{timeout:2e3}):setTimeout(t,1e3),document.querySelectorAll(".overflow-auto, .overflow-scroll").forEach(e=>{window.eventOptimizer.addPassiveListener(e,"scroll",function(e){})}),document.addEventListener("mouseover",function(e){const t=e.target.closest("a[href]");if(t&&t.href&&t.href.startsWith(window.location.origin)){const e=new URL(t.href).pathname;e.includes("/calendar")?window.scriptLoader.preload("/js/calendar-enhanced.js"):e.includes("/kanban")?window.scriptLoader.preload("/js/kanban-enhanced.js"):e.includes("/analytics")&&window.scriptLoader.preload("/js/dashboard-widgets.js")}},{passive:!0}),window.addEventListener("beforeunload",function(){window.eventOptimizer.debounceTimers.forEach(e=>clearTimeout(e)),window.eventOptimizer.throttleTimers.forEach(e=>clearTimeout(e))})}window.addEventListener("resize",o,{passive:!0}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n(),window.performanceOptimizer={loadScript:(e,t)=>window.scriptLoader.load(e,t),preloadScript:e=>window.scriptLoader.preload(e),debounce:(e,t)=>window.eventOptimizer.debounce(e,t),throttle:(e,t)=>window.eventOptimizer.throttle(e,t),getStats:()=>({scripts:window.scriptLoader.getStats(),memory:performance.memory?{usedJSHeapSize:performance.memory.usedJSHeapSize,totalJSHeapSize:performance.memory.totalJSHeapSize}:null})}}();