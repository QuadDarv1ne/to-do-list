if(function(){"use strict";function e(e){const n=e.value.trim();let o=!0,s="";return e.hasAttribute("required")&&!n?(o=!1,s="Это поле обязательно для заполнения"):"email"===e.type&&n&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)?(o=!1,s="Введите корректный email адрес"):"url"===e.type&&n&&!function(e){try{return new URL(e),!0}catch{return!1}}(n)?(o=!1,s="Введите корректный URL"):e.hasAttribute("minlength")&&n.length<e.getAttribute("minlength")&&(o=!1,s=`Минимальная длина: ${e.getAttribute("minlength")} символов`),o?(e.classList.remove("is-invalid"),e.classList.add("is-valid"),t(e)):(e.classList.remove("is-valid"),e.classList.add("is-invalid"),function(e,n){t(e);const o=document.createElement("div");o.className="invalid-feedback",o.textContent=n,e.parentNode.appendChild(o)}(e,s)),o}function t(e){const t=e.parentNode.querySelector(".invalid-feedback");t&&t.remove()}function n(){let e=document.getElementById("global-loading-indicator");e||(e=document.createElement("div"),e.id="global-loading-indicator",e.className="position-fixed top-0 start-0 w-100 bg-primary",e.style.height="3px",e.style.zIndex="9999",e.innerHTML='<div class="progress-bar progress-bar-striped progress-bar-animated w-100"></div>',document.body.appendChild(e)),e.style.display="block"}function o(){const e=document.getElementById("global-loading-indicator");e&&(e.style.display="none")}function s(e,t="info"){let n=document.getElementById("auto-save-indicator");n||(n=document.createElement("div"),n.id="auto-save-indicator",n.className="position-fixed bottom-0 end-0 m-3 p-3 rounded shadow",n.style.zIndex="9999",document.body.appendChild(n)),n.className=`position-fixed bottom-0 end-0 m-3 p-3 rounded shadow bg-${"success"===t?"success":"error"===t?"danger":"info"} text-white`,n.innerHTML=`<i class="fas fa-${"success"===t?"check":"error"===t?"times":"spinner fa-spin"} me-2"></i>${function(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}(e)}`,n.style.display="block","info"!==t&&setTimeout(()=>{n.style.display="none"},3e3)}document.addEventListener("DOMContentLoaded",function(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(e){return new bootstrap.Tooltip(e,{delay:{show:500,hide:100}})}),[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')).map(function(e){return new bootstrap.Popover(e)}),function(){document.querySelectorAll("form[data-validate]").forEach(t=>{t.querySelectorAll("input, textarea, select").forEach(t=>{t.addEventListener("blur",function(){e(this)}),t.addEventListener("input",function(){this.classList.contains("is-invalid")&&e(this)})})});document.querySelectorAll("textarea[maxlength]").forEach(e=>{const t=e.getAttribute("maxlength"),n=document.createElement("small");n.className="form-text text-muted",n.textContent=`0 / ${t}`,e.parentNode.appendChild(n),e.addEventListener("input",function(){const e=this.value.length;n.textContent=`${e} / ${t}`,n.className=e>.9*t?"form-text text-warning":"form-text text-muted"})});document.querySelectorAll("textarea[data-auto-resize]").forEach(e=>{e.style.overflow="hidden",e.addEventListener("input",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"})});document.querySelectorAll('input[type="password"][data-strength]').forEach(e=>{const t=document.createElement("div");t.className="password-strength-bar mt-2",t.innerHTML='<div class="password-strength-progress"></div>',e.parentNode.appendChild(t),e.addEventListener("input",function(){const e=function(e){let t=0;e.length>=8&&t++;e.length>=12&&t++;/[a-z]/.test(e)&&/[A-Z]/.test(e)&&t++;/\d/.test(e)&&t++;/[^a-zA-Z0-9]/.test(e)&&t++;return t}(this.value);!function(e,t){const n=e.querySelector(".password-strength-progress"),o=t/5*100;n.style.width=o+"%",n.className="password-strength-progress",t<=2?n.classList.add("bg-danger"):t<=3?n.classList.add("bg-warning"):n.classList.add("bg-success")}(t,e)})})}(),function(){document.querySelectorAll("table[data-sortable]").forEach(e=>{e.querySelectorAll("th[data-sort]").forEach(t=>{t.style.cursor="pointer",t.addEventListener("click",function(){sortTable(e,this)})})});document.querySelectorAll("table tbody tr").forEach(e=>{e.addEventListener("mouseenter",function(){this.style.transform="scale(1.01)"}),e.addEventListener("mouseleave",function(){this.style.transform="scale(1)"})})}(),function(){const e=document.querySelectorAll(".card"),t=new IntersectionObserver(e=>{e.forEach((e,n)=>{e.isIntersecting&&(setTimeout(()=>{e.target.classList.add("fade-in-up")},100*n),t.unobserve(e.target))})},{threshold:.1});e.forEach(e=>{t.observe(e)})}(),function(){const e=document.getElementById("select-all-tasks"),t=document.querySelectorAll(".task-checkbox"),n=document.getElementById("bulk-actions-container"),o=document.getElementById("selected-count"),s=document.getElementById("cancel-bulk-selection"),a=document.getElementById("bulk-action-select"),r=document.getElementById("tag-selection-container");e&&e.addEventListener("change",function(){t.forEach(e=>{e.checked=this.checked}),i()});t.forEach(e=>{e.addEventListener("change",i)}),s&&s.addEventListener("click",function(){t.forEach(e=>e.checked=!1),e&&(e.checked=!1),i()});a&&a.addEventListener("change",function(){"assign_tag"===this.value&&r?r.style.display="block":r&&(r.style.display="none")});function i(){const e=document.querySelectorAll(".task-checkbox:checked").length;e>0?(n?.classList.remove("d-none"),o&&(o.textContent=`Выбрано: ${e}`)):n?.classList.add("d-none")}}(),document.querySelectorAll('input[type="search"], input[name="search"]').forEach(e=>{let t;e.addEventListener("input",function(){clearTimeout(t);const e=this.parentNode.querySelector("i");e&&(e.className="fas fa-spinner fa-spin"),t=setTimeout(()=>{e&&(e.className="fas fa-search")},500)})}),document.querySelectorAll("form").forEach(e=>{e.addEventListener("submit",function(e){const t=this.querySelector('button[type="submit"]');if(t&&!t.disabled){t.disabled=!0;const e=t.innerHTML;t.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Загрузка...',setTimeout(()=>{t.disabled=!1,t.innerHTML=e},5e3)}})}),document.addEventListener("ajaxStart",function(){n()}),document.addEventListener("ajaxComplete",function(){o()}),document.querySelectorAll("a[data-confirm], button[data-confirm]").forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("data-confirm")||"Вы уверены?";if(!confirm(t))return e.preventDefault(),!1})}),document.querySelectorAll("form[data-auto-save]").forEach(e=>{let t;e.querySelectorAll("input, textarea, select").forEach(n=>{n.addEventListener("input",function(){clearTimeout(t),s("Сохранение..."),t=setTimeout(()=>{!function(e){const t=new FormData(e),n=e.getAttribute("data-auto-save-url")||e.action;fetch(n,{method:"POST",body:t,headers:{"X-Requested-With":"XMLHttpRequest"}}).then(e=>e.json()).then(e=>{e.success?s("Сохранено","success"):s("Ошибка сохранения","error")}).catch(()=>{s("Ошибка сохранения","error")})}(e)},2e3)})})}),document.addEventListener("keydown",function(e){if((e.ctrlKey||e.metaKey)&&"k"===e.key){e.preventDefault();const t=document.querySelector('input[name="search"]');t&&(t.focus(),t.select())}if((e.ctrlKey||e.metaKey)&&"s"===e.key){const t=document.querySelector("form");t&&(e.preventDefault(),t.requestSubmit())}})}),window.TaskManagerUI={showToast:function(e,t="info"){"function"==typeof window.showToast&&window.showToast(e,t)},showLoading:n,hideLoading:o,validateField:e}}(),!document.getElementById("passwordStrengthStyles")){const e=document.createElement("style");e.id="passwordStrengthStyles",e.textContent="\n    .password-strength-bar {\n        height: 4px;\n        background: #e9ecef;\n        border-radius: 2px;\n        overflow: hidden;\n    }\n    \n    .password-strength-progress {\n        height: 100%;\n        transition: width 0.3s ease, background-color 0.3s ease;\n    }\n    \n    #auto-save-indicator {\n        animation: slideInRight 0.3s ease-out;\n    }\n    \n    @keyframes slideInRight {\n        from {\n            transform: translateX(100%);\n            opacity: 0;\n        }\n        to {\n            transform: translateX(0);\n            opacity: 1;\n        }\n    }\n",document.head.appendChild(e)}